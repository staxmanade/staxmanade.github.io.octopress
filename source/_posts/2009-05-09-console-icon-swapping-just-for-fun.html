---
layout: post
title: "Console Icon Swapping – Just for fun…"
date: 2009-05-09T23:48:00-07:00
comments: false
---

<div class='post'>
<p>I took the new logo for <a title="Silverlight Testing Automation Tool" href="http://statlight.net/" target="_blank">StatLight</a> and created a/an .ico (by going to <a href="http://www.convertico.com/" target="_blank">convertico.com</a>) for use as a <a href="http://en.wikipedia.org/wiki/Favicon" target="_blank">FavIcon</a> and so I could fancy up a couple of the windows just for fun. What I ended up figuring out, was how to change the icon for a running console window.</p>  <p>It’s actually pretty easy… Here is the class I wrote and use.</p>  <pre><span style="color: #0000ff">internal</span> <span style="color: #0000ff">class</span> ConsoleIconSwapper : IDisposable<br />{<br />    IntPtr consoleWindowHwnd;<br /><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">const</span> <span style="color: #0000ff">int</span> WM_SETICON = 0x80;	<span style="color: #008000">// Api constant</span><br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">const</span> <span style="color: #0000ff">int</span> ICON_SMALL = 0;	<span style="color: #008000">// Api constant</span><br /><br />    [DllImport(&quot;<span style="color: #8b0000">user32.dll</span>&quot;)]<br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">extern</span> <span style="color: #0000ff">int</span> SendMessage(IntPtr hwnd, <span style="color: #0000ff">int</span> message, <span style="color: #0000ff">int</span> wParam, IntPtr lParam);<br /><br />    [DllImport(&quot;<span style="color: #8b0000">kernel32</span>&quot;)]<br />    <span style="color: #0000ff">private</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">extern</span> IntPtr GetConsoleWindow();<br /><br />    <span style="color: #0000ff">public</span> ConsoleIconSwapper()<br />    {<br />        consoleWindowHwnd = GetConsoleWindow();<br />    }<br /><br />    <span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> ShowConsoleIcon(Icon icon)<br />    {<br />        SendMessage(consoleWindowHwnd, WM_SETICON, ICON_SMALL, icon.Handle);<br />    }<br /><br />    <span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> ChangeIconback()<br />    {<br />        SendMessage(consoleWindowHwnd, WM_SETICON, ICON_SMALL, (IntPtr)0);<br />    }<br /><br />    <span style="color: #0000ff">public</span> <span style="color: #0000ff">void</span> Dispose()<br />    {<br />        ChangeIconback();<br />    }<br />}</pre><br /><br /><p>And here is how I use it.</p><br /><br /><pre><span style="color: #0000ff">using</span> (var consoleIconSwapper = <span style="color: #0000ff">new</span> ConsoleIconSwapper())<br />{<br />    consoleIconSwapper.ShowConsoleIcon(CoreResources.FavIcon);<br />    <span style="color: #008000">/*<br />     *  Code Here<br />     */</span><br />}</pre><br /><br /><p>This is what it looks like when in use…</p><br /><br /><p>Before:<a href="http://lh6.ggpht.com/_L6Vw0x_R3iw/SgZ4p24wrvI/AAAAAAAAAIA/jrcqzHB68ek/s1600-h/image%5B21%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/_L6Vw0x_R3iw/SgZ4qKHQ1wI/AAAAAAAAAIE/37QrEplXSvs/image_thumb%5B9%5D.png?imgmax=800" width="175" height="32" /></a><br /><br />  <br />During:<a href="http://lh4.ggpht.com/_L6Vw0x_R3iw/SgZ4qaSofLI/AAAAAAAAAII/gD57RvvY0QM/s1600-h/image%5B22%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/_L6Vw0x_R3iw/SgZ4qswfXEI/AAAAAAAAAIQ/WQoqtYfLgLo/image_thumb%5B10%5D.png?imgmax=800" width="162" height="48" /></a> <br /><br />  <br />After:<a href="http://lh5.ggpht.com/_L6Vw0x_R3iw/SgZ4q51vbkI/AAAAAAAAAIY/tM64Vif9A04/s1600-h/image%5B25%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/_L6Vw0x_R3iw/SgZ4rAQeMhI/AAAAAAAAAIg/UrpNW9pDftU/image_thumb%5B13%5D.png?imgmax=800" width="175" height="32" /></a></p><br /><br /><p>Amused by simple things :)</p>  </div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>CLS</div>
<div class='content'>
Thanks man!<br /><br />It works fine.</div>
</div>
</div>
